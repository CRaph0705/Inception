#Initialisation de l'environnement de dev

1) Créer VM
> OS : pultimate stable (debian : bookworm)

2) Installer Docker

sudo apt update
sudo apt install ca-certificates curl gnupg

sudo install -m 0755 -d /etc/apt/keyrings

curl -fsSL https://download.docker.com/linux/debian/gpg \
  | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg

echo \
  "deb [arch=$(dpkg --print-architecture) \
  signed-by=/etc/apt/keyrings/docker.gpg] \
  https://download.docker.com/linux/debian \
  $(. /etc/os-release && echo "$VERSION_CODENAME") stable" \
  | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null

sudo apt update
sudo apt install docker-ce docker-ce-cli containerd.io docker-compose-plugin

3) Ajouter l'utilisateur au groupe docker

sudo usermod -aG docker $USER
newgrp docker

Test :
docker run hello-world
docker compose version

#Structurer le projet

Inception/
    README.md
    .gitignore
    docker-compose.yml
    Makefile
    srcs/requirements/
        mariadb/
            Dockerfile
            tools/init.sh
        wordpress/
            Dockerfile
            tools/init.sh
        nginx/
            Dockerfile
            tools/init.sh


#Les volumes

Dans le sujet : les volumes doivent stocker leurs données dans /home/login/data

1) On créé les dossiers :
mkdir -p /home/login/data/mariadb
mkdir -p /home/login/data/wordpress
mkdir -p /home/login/data/nginx (pour les logs ?)


Dans le docker-compose.yml :

volumes:
  mariadb_data:
    driver: local
    driver_opts:
      type: none
      o: bind
      device: /home/login/data/mariadb

  wordpress_data:
    driver: local
    driver_opts:
      type: none
      o: bind
      device: /home/login/data/wordpress

  nginx_data:
    driver: local
    driver_opts:
      type: none
      o: bind
      device: /home/login/data/nginx
    
